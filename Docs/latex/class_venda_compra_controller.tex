\doxysection{Referência à classe Venda\+Compra\+Controller}
\label{class_venda_compra_controller}\index{VendaCompraController@{VendaCompraController}}
Diagrama de heranças da classe Venda\+Compra\+Controller\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_venda_compra_controller}
\end{center}
\end{figure}
\doxysubsubsection*{Membros públicos}
\begin{DoxyCompactItemize}
\item 
\textbf{ Venda\+Compra\+Controller} ()
\begin{DoxyCompactList}\small\item\em Construtor da classe \doxyref{Venda\+Compra\+Controller}{p. }{class_venda_compra_controller}. Inicializa o controlador com o caminho do ficheiro de dados onde as vendas são armazenadas. \end{DoxyCompactList}\item 
\textbf{ override} \textbf{ List}$<$ \textbf{ object} $>$ \textbf{ Get\+Items} ()
\begin{DoxyCompactList}\small\item\em Obtém os itens de vendas e compras formatados para exibição. \end{DoxyCompactList}\item 
\textbf{ override} \textbf{ void} \textbf{ Remove\+Item} (\textbf{ object} \textbf{ item})
\begin{DoxyCompactList}\small\item\em Remove uma venda do sistema após verificar a garantia e atualizar o estoque. \end{DoxyCompactList}\item 
\textbf{ int} \textbf{ Calcula\+Garantia} (\textbf{ Utilizador} cliente)
\begin{DoxyCompactList}\small\item\em Calcula o período de garantia da compra com base no tipo de cliente. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Membros públicos herdados de \textbf{ Base\+Controller$<$ Venda\+Compra $>$}}
\begin{DoxyCompactItemize}
\item 
\textbf{ Base\+Controller} (\textbf{ string} file\+Path)
\begin{DoxyCompactList}\small\item\em Construtor da classe \doxyref{Base\+Controller}{p. }{class_base_controller}. Inicializa o repositório com base no caminho de ficheiro fornecido. \end{DoxyCompactList}\item 
\textbf{ void} \textbf{ Add\+Item} (\textbf{ T} \textbf{ item})
\begin{DoxyCompactList}\small\item\em Adiciona um novo item ao repositório. \end{DoxyCompactList}\item 
\textbf{ object} \textbf{ Get\+By\+Id} (\textbf{ int}? \textbf{ id})
\begin{DoxyCompactList}\small\item\em Obtém um item pelo seu identificador. \end{DoxyCompactList}\item 
\textbf{ virtual} \textbf{ void} \textbf{ Update\+Item} (\textbf{ object} \textbf{ item})
\begin{DoxyCompactList}\small\item\em Atualiza um item específico. Este método pode ser re-\/implementado pelas classes derivadas para definir a lógica de atualização. \end{DoxyCompactList}\item 
\textbf{ List}$<$ \textbf{ object} $>$ \textbf{ Filtrar\+Itens} (\textbf{ List}$<$ \textbf{ object} $>$ items, \textbf{ string} \textbf{ filtro}, \textbf{ string} \textbf{ coluna})
\begin{DoxyCompactList}\small\item\em Filtra itens com base em uma propriedade e um filtro. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Membros públicos herdados de \textbf{ IEntity\+Controller}}
\begin{DoxyCompactItemize}
\item 
object \textbf{ Get\+By\+Id} (int? id)
\begin{DoxyCompactList}\small\item\em Obtém um item pelo seu identificador único. \end{DoxyCompactList}\item 
void \textbf{ Update\+Item} (object item)
\begin{DoxyCompactList}\small\item\em Atualiza os dados de um item existente no sistema. \end{DoxyCompactList}\item 
List$<$ object $>$ \textbf{ Filtrar\+Itens} (List$<$ object $>$ items, string filtro, string? coluna)
\begin{DoxyCompactList}\small\item\em Filtra itens com base em critérios específicos. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Outros membros herdados}
\doxysubsection*{Atributos Protegidos herdados de \textbf{ Base\+Controller$<$ Venda\+Compra $>$}}
\begin{DoxyCompactItemize}
\item 
\textbf{ readonly} \textbf{ Base\+Repo}$<$ \textbf{ T} $>$ \textbf{ \+\_\+repository}
\begin{DoxyCompactList}\small\item\em Referência ao repositório base utilizado para operações nos itens. \end{DoxyCompactList}\item 
\textbf{ List}$<$ \textbf{ T} $>$ \textbf{ \+\_\+items}
\begin{DoxyCompactList}\small\item\em Lista local de itens atualmente carregados. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Descrição detalhada}


Definido na linha \textbf{ 8} do ficheiro \textbf{ Venda\+Compra\+Controller.\+cs}.



\doxysubsection{Documentação dos Construtores \& Destrutor}
\label{class_venda_compra_controller_a93b083e50906dc91b931a6c8cd6ea4fe} 
\index{VendaCompraController@{VendaCompraController}!VendaCompraController@{VendaCompraController}}
\index{VendaCompraController@{VendaCompraController}!VendaCompraController@{VendaCompraController}}
\doxysubsubsection{VendaCompraController()}
{\footnotesize\ttfamily Venda\+Compra\+Controller.\+Venda\+Compra\+Controller (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Construtor da classe \doxyref{Venda\+Compra\+Controller}{p. }{class_venda_compra_controller}. Inicializa o controlador com o caminho do ficheiro de dados onde as vendas são armazenadas. 



Definido na linha \textbf{ 25} do ficheiro \textbf{ Venda\+Compra\+Controller.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00025\ :\ base(\textcolor{stringliteral}{"{}Data/vendas.json"{}})\ \{\ \}}

\end{DoxyCode}


\doxysubsection{Documentação das funções}
\label{class_venda_compra_controller_aaa36d55d39764c42667a175744e89e76} 
\index{VendaCompraController@{VendaCompraController}!CalculaGarantia@{CalculaGarantia}}
\index{CalculaGarantia@{CalculaGarantia}!VendaCompraController@{VendaCompraController}}
\doxysubsubsection{CalculaGarantia()}
{\footnotesize\ttfamily \textbf{ int} Venda\+Compra\+Controller.\+Calcula\+Garantia (\begin{DoxyParamCaption}\item[{\textbf{ Utilizador}}]{cliente }\end{DoxyParamCaption})}



Calcula o período de garantia da compra com base no tipo de cliente. 


\begin{DoxyParams}{Parâmetros}
{\em cliente} & O objeto Utilizador representando o cliente.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Retorna}
O período de garantia em meses (36 para particulares, 12 para empresas).
\end{DoxyReturn}


Definido na linha \textbf{ 115} do ficheiro \textbf{ Venda\+Compra\+Controller.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00116\ \ \ \ \ \{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ nifString\ =\ cliente.Nif.ToString();}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nifString.Length\ ==\ 9)}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Clientes\ particulares\ têm\ NIF\ começando\ com\ '1',\ '2'\ ou\ '3'}}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nifString.StartsWith(\textcolor{stringliteral}{"{}1"{}})\ ||\ nifString.StartsWith(\textcolor{stringliteral}{"{}2"{}})\ ||\ nifString.StartsWith(\textcolor{stringliteral}{"{}3"{}}))}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 36;\ \textcolor{comment}{//\ Garantia\ de\ 36\ meses}}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 12;\ \textcolor{comment}{//\ Garantia\ de\ 12\ meses\ para\ empresas}}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Garantia\ padrão\ em\ caso\ de\ NIF\ inválido}}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 36;}
\DoxyCodeLine{00134\ \ \ \ \ \}}

\end{DoxyCode}
\label{class_venda_compra_controller_a812cf00477a1fad3bf6bf8d84ac8fb63} 
\index{VendaCompraController@{VendaCompraController}!GetItems@{GetItems}}
\index{GetItems@{GetItems}!VendaCompraController@{VendaCompraController}}
\doxysubsubsection{GetItems()}
{\footnotesize\ttfamily \textbf{ override} \textbf{ List}$<$ \textbf{ object} $>$ Venda\+Compra\+Controller.\+Get\+Items (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Obtém os itens de vendas e compras formatados para exibição. 

\begin{DoxyReturn}{Retorna}
Uma lista de objetos representando as vendas e compras formatadas para exibição.
\end{DoxyReturn}


Reimplementado de \textbf{ Base\+Controller$<$ Venda\+Compra $>$} \doxyref{}{p. }{class_base_controller_ab123bcc53c016d37e86c07a4d7cbe3a4}.



Definido na linha \textbf{ 35} do ficheiro \textbf{ Venda\+Compra\+Controller.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00036\ \ \ \ \ \{}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ List<VendaCompra>\ vendas\ =\ \_repository.GetAll();}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \_vendasComprasViewItems\ =\ \textcolor{keyword}{new}\ List<VendaCompraViewModel>();}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (var\ venda\ \textcolor{keywordflow}{in}\ vendas)}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Busca\ o\ cliente\ pelo\ ID}}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ Utilizador?\ cliente\ =\ (Utilizador?)\textcolor{keyword}{new}\ UtilizadorController().GetById(venda.ClienteID);}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Criação\ de\ um\ ViewModel\ formatado\ para\ exibição}}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ var\ vendaCompraViewModel\ =\ \textcolor{keyword}{new}\ VendaCompraViewModel}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Id\ =\ venda.Id,}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ClienteNome\ =\ cliente?.Nome,}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ClienteID\ =\ cliente?.Id,}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NIF\ =\ venda.NIF,}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DataVenda\ =\ venda.DataVenda,}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TotalLiquido\ =\ venda.TotalLiquido,}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MetodoPagamento\ =\ venda.MetodoPagamento.ToString()}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ \_vendasComprasViewItems.Add(vendaCompraViewModel);}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_vendasComprasViewItems.Cast<\textcolor{keywordtype}{object}>().ToList();}
\DoxyCodeLine{00061\ \ \ \ \ \}}

\end{DoxyCode}
\label{class_venda_compra_controller_adaf95e7c5855fc3d27b14ac29d01ea55} 
\index{VendaCompraController@{VendaCompraController}!RemoveItem@{RemoveItem}}
\index{RemoveItem@{RemoveItem}!VendaCompraController@{VendaCompraController}}
\doxysubsubsection{RemoveItem()}
{\footnotesize\ttfamily \textbf{ override} \textbf{ void} Venda\+Compra\+Controller.\+Remove\+Item (\begin{DoxyParamCaption}\item[{\textbf{ object}}]{item }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Remove uma venda do sistema após verificar a garantia e atualizar o estoque. 


\begin{DoxyParams}{Parâmetros}
{\em item} & O item de venda a ser removido.\\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Excepções}
{\em Invalid\+Operation\+Exception} & Se a data de fim da garantia for inválida.\\
\hline
\end{DoxyExceptions}


Reimplementado de \textbf{ Base\+Controller$<$ Venda\+Compra $>$} \doxyref{}{p. }{class_base_controller_a8484ff644f75ab6d44e5e902b19e896e}.



Definido na linha \textbf{ 72} do ficheiro \textbf{ Venda\+Compra\+Controller.\+cs}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00073\ \ \ \ \ \{}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (item\ is\ VendaCompra\ specificItem)}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ ProdutoController\ produtoController\ =\ \textcolor{keyword}{new}\ ProdutoController();}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Verifica\ a\ validade\ da\ garantia}}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (DateTime.TryParse(specificItem.FimDataGarantia,\ out\ DateTime\ dataFimGarantia))}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (DateTime.Now\ <=\ dataFimGarantia)}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (ItemVenda\ itemVenda\ \textcolor{keywordflow}{in}\ specificItem.Itens)}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Produto\ produto\ =\ (Produto)produtoController.GetById(itemVenda.ProdutoID);}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (produto\ !=\ \textcolor{keyword}{null})}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reverte\ o\ estoque\ com\ base\ nas\ unidades\ vendidas}}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ produto.QuantidadeEmStock\ +=\ itemVenda.Unidades;}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ produtoController.UpdateItem(produto);}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ InvalidOperationException(\textcolor{stringliteral}{"{}A\ data\ de\ fim\ da\ garantia\ é\ inválida."{}});}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Remove\ a\ venda\ do\ repositório}}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \_repository.Remove(specificItem);}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00104\ \ \ \ \ \}}

\end{DoxyCode}


A documentação para esta classe foi gerada a partir do seguinte ficheiro\+:\begin{DoxyCompactItemize}
\item 
POO\+\_\+\+TP\+\_\+29559/\+Controllers/\textbf{ Venda\+Compra\+Controller.\+cs}\end{DoxyCompactItemize}
