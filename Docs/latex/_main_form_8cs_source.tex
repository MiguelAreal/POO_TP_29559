\doxysection{Main\+Form.\+cs}
\label{_main_form_8cs_source}\index{POO\_TP\_29559/Views/MainForm.cs@{POO\_TP\_29559/Views/MainForm.cs}}
\textbf{ Ir para a documentaÃ§Ã£o deste ficheiro.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{keyword}{using\ }MetroFramework.Forms;}
\DoxyCodeLine{00002\ \textcolor{keyword}{using\ }poo\_tp\_29559.Views;}
\DoxyCodeLine{00003\ \textcolor{keyword}{using\ }poo\_tp\_29559.Repositories.Enumerators;}
\DoxyCodeLine{00004\ \textcolor{keyword}{using\ }poo\_tp\_29559.Models;}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{keyword}{namespace\ }poo\_tp\_29559}
\DoxyCodeLine{00007\ \{}
\DoxyCodeLine{00011\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{partial\ class\ }MainForm\ :\ MetroForm}
\DoxyCodeLine{00012\ \ \ \ \ \{}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#region\ Private\ Fields}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ readonly\ Utilizador\ \_utilizadorLogado;}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#endregion}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#region\ Construtors}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ MainForm(Utilizador\ utilizadorLogado)}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \ \ \ \ InitializeComponent();}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ \ \_utilizadorLogado\ =\ utilizadorLogado;}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Configura\ informações\ visíveis\ do\ utilizador\ autenticado}}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ tipoUser\ =\ \_utilizadorLogado.IsAdmin\ ?\ \textcolor{stringliteral}{"{}Administrador"{}}\ :\ \textcolor{stringliteral}{"{}Cliente"{}};}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ lblUserInfo.Text\ =\ \$\textcolor{stringliteral}{"{}\{\_utilizadorLogado.Nome\}\(\backslash\)n\{tipoUser\}"{}};}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Configura\ visibilidade\ dos\ menus\ com\ base\ no\ tipo\ de\ utilizador}}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ ConfigurarMenus();}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#endregion}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#region\ Methods}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keywordtype}{void}\ ConfigurarMenus()}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_utilizadorLogado.IsAdmin)}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ comprasTSMI.Visible\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vendasTSMI.Visible\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ utilizadoresTSMI.Visible\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keywordtype}{void}\ AbrirFormNoPanel(Form\ formFilho)}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Remove\ formulário\ existente\ no\ painel,\ se\ houver}}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (panelContainer.Controls.Count\ >\ 1)}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ panelContainer.Controls[1].Dispose();}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Esconde\ a\ imagem\ de\ fundo}}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ picBg.Hide();}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Configura\ evento\ ao\ fechar\ o\ formulário,\ para\ voltar\ a\ mostrar\ a\ imagem\ de\ fundo.}}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ formFilho.FormClosed\ +=\ (s,\ args)\ =>\ picBg.Show();}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Configura\ e\ exibe\ o\ formulário\ filho}}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ formFilho.TopLevel\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ formFilho.Dock\ =\ DockStyle.Fill;}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ panelContainer.Controls.Add(formFilho);}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ formFilho.Show();}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ Form\ CriarFormulario(FormTypes\ tipoForm)}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ ChildForm(tipoForm,\ \_utilizadorLogado);}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#endregion}}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#region\ Menu\ Events}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keywordtype}{void}\ msMainForm\_ItemClicked(\textcolor{keywordtype}{object}\ sender,\ ToolStripItemClickedEventArgs\ e)}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reset\ nas\ cores\ de\ todos\ os\ itens.}}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ msMainForm.Items.Count;\ i++)}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ msMainForm.Items[i].ForeColor\ =\ Color.Black;}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ msMainForm.Items[i].BackColor\ =\ Color.Transparent;}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ Form?\ formFilho\ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Determina\ o\ formulário\ a\ abrir\ com\ base\ no\ item\ selecionado}}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (e.ClickedItem?.Text)}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{"{}Produtos"{}}:}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ formFilho\ =\ CriarFormulario(FormTypes.Produtos);}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{"{}Categorias"{}}:}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ formFilho\ =\ CriarFormulario(FormTypes.Categorias);}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{"{}Marcas"{}}:}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ formFilho\ =\ CriarFormulario(FormTypes.Marcas);}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{"{}Utilizadores"{}}:}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ formFilho\ =\ CriarFormulario(FormTypes.Utilizadores);}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{"{}Campanhas"{}}:}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ formFilho\ =\ CriarFormulario(FormTypes.Campanhas);}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{"{}Vendas"{}}:}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ formFilho\ =\ CriarFormulario(FormTypes.Vendas);}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{"{}Compras"{}}:}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ formFilho\ =\ CriarFormulario(FormTypes.Compras);}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MessageBox.Show(\textcolor{stringliteral}{"{}Opção\ desconhecida."{}});}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Muda\ a\ cor\ do\ item\ selecionado.}}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ e.ClickedItem.ForeColor\ =\ Color.White;}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ e.ClickedItem.BackColor\ =\ Color.FromArgb(9,\ 171,\ 219);}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Abre\ o\ formulário,\ se\ válido}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (formFilho\ !=\ \textcolor{keyword}{null})}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AbrirFormNoPanel(formFilho);}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#endregion}}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#region\ External\ Events}}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keywordtype}{void}\ github\_Click(\textcolor{keywordtype}{object}\ sender,\ EventArgs\ e)}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ var\ processStartInfo\ =\ \textcolor{keyword}{new}\ System.Diagnostics.ProcessStartInfo}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FileName\ =\ \textcolor{stringliteral}{"{}https://github.com/MiguelAreal/POO\_TP\_29559"{}},}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ UseShellExecute\ =\ \textcolor{keyword}{true}}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ System.Diagnostics.Process.Start(processStartInfo);}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}\ (Exception\ ex)}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MessageBox.Show(\$\textcolor{stringliteral}{"{}Erro:\ \{ex.Message\}"{}},\ \textcolor{stringliteral}{"{}Erro"{}},\ MessageBoxButtons.OK,\ MessageBoxIcon.Error);}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00195\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#endregion}}
\DoxyCodeLine{00196\ \ \ \ \ \}}
\DoxyCodeLine{00197\ \}}

\end{DoxyCode}
